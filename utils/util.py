import csv
import os
import pickle
import numpy as np


def ensure_dir(path):
    if not os.path.exists(path):
        os.makedirs(path)


def create_labels_and_ids_dicts(csv_path='/home/natasha/detection_kaggle/train/train-annotations-bbox.csv'):
    all_labels_names = []
    with open(csv_path, 'r') as csv_file:
        reader = csv.reader(csv_file, delimiter=',', dialect='excel')
        for row in list(reader)[1:]:
            # ImageID Source LabelName Confidence XMin XMax YMin YMax IsOccluded IsTruncated IsGroupOf IsDepiction IsInside
            label_name = row[2]
            all_labels_names.append(label_name)
    unique_labels_names = np.unique(np.array(all_labels_names))
    dictionary_label_name_to_id = {}
    dictionary_id_to_label_name = {}
    for i, label_name in enumerate(unique_labels_names):
        dictionary_label_name_to_id[label_name] = i
        dictionary_id_to_label_name[i] = label_name
    with open('../helper_files/labels_dictionary.pkl', 'wb') as f:
        pickle.dump(dictionary_label_name_to_id, f)
    with open('../helper_files/ids_dictionary.pkl', 'wb') as f:
        pickle.dump(dictionary_id_to_label_name, f)


def get_labels_dict():
    with open('helper_files/labels_dictionary.pkl', 'rb') as f:
        dictionary = pickle.load(f)
    return dictionary


def get_ids_dict():
    with open('helper_files/ids_dictionary.pkl', 'rb') as f:
        dictionary = pickle.load(f)
    return dictionary


# create_labels_and_ids_dicts(csv_path='/home/natasha/detection_kaggle/train/train-annotations-bbox.csv')

# dictionary = get_labels_dict()
# print(dictionary)
# {'/m/011k07': 0, '/m/012074': 1, '/m/0120dh': 2, '/m/01226z': 3, '/m/012n7d': 4, '/m/012w5l': 5, '/m/012xff': 6, '/m/012ysf': 7, '/m/0130jx': 8, '/m/0138tl': 9, '/m/013y1f': 10, '/m/01432t': 11, '/m/014j1m': 12, '/m/014sv8': 13, '/m/014trl': 14, '/m/014y4n': 15, '/m/0152hh': 16, '/m/01599': 17, '/m/015h_t': 18, '/m/015p6': 19, '/m/015qbp': 20, '/m/015qff': 21, '/m/015wgc': 22, '/m/015x4r': 23, '/m/015x5n': 24, '/m/0162_1': 25, '/m/0167gd': 26, '/m/016m2d': 27, '/m/0174k2': 28, '/m/0174n1': 29, '/m/0175cv': 30, '/m/0176mf': 31, '/m/017ftj': 32, '/m/018j2': 33, '/m/018p4k': 34, '/m/018xm': 35, '/m/01940j': 36, '/m/0199g': 37, '/m/019dx1': 38, '/m/019h78': 39, '/m/019jd': 40, '/m/019w40': 41, '/m/01_5g': 42, '/m/01_bhs': 43, '/m/01b638': 44, '/m/01b7fy': 45, '/m/01b9xk': 46, '/m/01bfm9': 47, '/m/01bjv': 48, '/m/01bl7v': 49, '/m/01bms0': 50, '/m/01bqk0': 51, '/m/01btn': 52, '/m/01c648': 53, '/m/01cmb2': 54, '/m/01d380': 55, '/m/01d40f': 56, '/m/01dws': 57, '/m/01dwsz': 58, '/m/01dwwc': 59, '/m/01dxs': 60, '/m/01dy8n': 61, '/m/01f8m5': 62, '/m/01f91_': 63, '/m/01fb_0': 64, '/m/01fdzj': 65, '/m/01fh4r': 66, '/m/01g317': 67, '/m/01g3x7': 68, '/m/01gkx_': 69, '/m/01gllr': 70, '/m/01gmv2': 71, '/m/01h3n': 72, '/m/01h44': 73, '/m/01h8tj': 74, '/m/01hrv5': 75, '/m/01j3zr': 76, '/m/01j4z9': 77, '/m/01j51': 78, '/m/01j5ks': 79,
#
# '/m/01j61q': 80, '/m/01jfm_': 81, '/m/01jfsr': 82, '/m/01k6s3': 83, '/m/01kb5b': 84, '/m/01knjb': 85, '/m/01krhy': 86, '/m/01lcw4': 87, '/m/01llwg': 88, '/m/01lrl': 89, '/m/01lsmm': 90, '/m/01lynh': 91, '/m/01m2v': 92, '/m/01m4t': 93, '/m/01mqdt': 94, '/m/01mzpv': 95, '/m/01n4qj': 96, '/m/01n5jq': 97, '/m/01nkt': 98, '/m/01nq26': 99, '/m/01pns0': 100, '/m/01prls': 101, '/m/01r546': 102, '/m/01rkbr': 103, '/m/01rzcn': 104, '/m/01s105': 105, '/m/01s55n': 106, '/m/01tcjp': 107, '/m/01vbnl': 108, '/m/01ww8y': 109, '/m/01x3jk': 110, '/m/01x3z': 111, '/m/01x_v': 112, '/m/01xgg_': 113, '/m/01xq0k1': 114, '/m/01xqw': 115, '/m/01xs3r': 116, '/m/01xygc': 117, '/m/01xyhv': 118, '/m/01y9k5': 119, '/m/01yrx': 120, '/m/01yx86': 121, '/m/01z1kdw': 122, '/m/02068x': 123, '/m/020jm': 124, '/m/020kz': 125, '/m/020lf': 126, '/m/021mn': 127, '/m/021sj1': 128, '/m/0220r2': 129, '/m/0242l': 130, '/m/024d2': 131, '/m/024g6': 132, '/m/02522': 133, '/m/025dyy': 134, '/m/025fsf': 135, '/m/025nd': 136, '/m/025rp__': 137, '/m/0268lbt': 138, '/m/026qbn5': 139, '/m/026t6': 140, '/m/0270h': 141, '/m/0271qf7': 142, '/m/0271t': 143, '/m/027pcv': 144, '/m/027rl48': 145, '/m/0283dt1': 146, '/m/0284d': 147, '/m/029b3': 148, '/m/029bxz': 149, '/m/029tx': 150, '/m/02_n6y': 151, '/m/02bm9n': 152, '/m/02crq1': 153, '/m/02ctlc': 154, '/m/02cvgx': 155, '/m/02d1br': 156, '/m/02d9qx': 157, '/m/02ddwp': 158, '/m/02dgv': 159, '/m/02dl1y': 160, '/m/02f9f_': 161, '/m/02fh7f': 162, '/m/02fq_6': 163, '/m/02g30s': 164, '/m/02gzp': 165, '/m/02h19r': 166, '/m/02hj4': 167, '/m/02jfl0': 168, '/m/02jnhm': 169, '/m/02jvh9': 170, '/m/02jz0l': 171, '/m/02l8p9': 172, '/m/02lbcq': 173, '/m/02mqfb': 174, '/m/02p0tk3': 175, '/m/02p3w7d': 176, '/m/02p5f1q': 177, '/m/02pdsw': 178, '/m/02pjr4': 179, '/m/02pkr5': 180, '/m/02pv19': 181, '/m/02rdsp': 182, '/m/02rgn06': 183, '/m/02s195': 184, '/m/02tsc9': 185, '/m/02vkqh8': 186, '/m/02vqfm': 187, '/m/02vwcm': 188, '/m/02w3_ws': 189, '/m/02w3r3': 190, '/m/02wbm': 191, '/m/02wbtzl': 192, '/m/02wg_p': 193, '/m/02wmf': 194, '/m/02wv6h6': 195, '/m/02wv84t': 196, '/m/02x8cch': 197, '/m/02x984l': 198, '/m/02xb7qb': 199, '/m/02xqq': 200, '/m/02xwb': 201, '/m/02y6n': 202, '/m/02z51p': 203, '/m/02zn6n': 204, '/m/02zt3': 205, '/m/02zvsm': 206, '/m/030610': 207, '/m/0306r': 208, '/m/03120': 209, '/m/0319l': 210, '/m/031b6r': 211, '/m/031n1': 212, '/m/0323sq': 213, '/m/032b3c': 214, '/m/033cnk': 215, '/m/033rq4': 216, '/m/0342h': 217, '/m/034c16': 218, '/m/035r7c': 219, '/m/035vxb': 220, '/m/0388q': 221, '/m/039xj_': 222, '/m/03__z0': 223, '/m/03bbps': 224, '/m/03bj1': 225, '/m/03bk1': 226, '/m/03bt1vf': 227, '/m/03c7gz': 228, '/m/03d443': 229, '/m/03dnzn': 230, '/m/03fj2': 231, '/m/03fp41': 232, '/m/03fwl': 233, '/m/03g8mr': 234, '/m/03grzl': 235, '/m/03hj559': 236, '/m/03hl4l9': 237, '/m/03hlz0c': 238, '/m/03jbxj': 239, '/m/03jm5': 240, '/m/03k3r': 241, '/m/03kt2w': 242, '/m/03l9g': 243, '/m/03ldnb': 244, '/m/03m3pdh': 245, '/m/03m3vtv': 246, '/m/03m5k': 247, '/m/03nfch': 248, '/m/03p3bw': 249, '/m/03q5c7': 250, '/m/03q5t': 251, '/m/03q69': 252, '/m/03qhv5': 253, '/m/03qjg': 254, '/m/03qrc': 255, '/m/03rszm': 256, '/m/03s_tn': 257, '/m/03ssj5': 258, '/m/03tw93': 259, '/m/03txqz': 260, '/m/03v5tg': 261, '/m/03vt0': 262, '/m/03wvsk': 263, '/m/03wym': 264, '/m/03xxp': 265, '/m/03y6mg': 266, '/m/040b_t': 267, '/m/04169hn': 268, '/m/0420v5': 269, '/m/043nyj': 270, '/m/0440zs': 271, '/m/0449p': 272, '/m/044r5d': 273, '/m/0463sg': 274, '/m/046dlr': 275, '/m/047j0r': 276, '/m/047v4b': 277, '/m/04_sv': 278, '/m/04bcr3': 279, '/m/04brg2': 280, '/m/04c0y': 281, '/m/04cp_': 282, '/m/04ctx': 283, '/m/04dr76w': 284, '/m/04f5ws': 285, '/m/04g2r': 286, '/m/04gth': 287, '/m/04h7h': 288, '/m/04h8sr': 289, '/m/04hgtk': 290, '/m/04kkgm': 291, '/m/04lvq_': 292, '/m/04m6gz': 293, '/m/04m9y': 294, '/m/04p0qw': 295, '/m/04rky': 296, '/m/04rmv': 297, '/m/04szw': 298, '/m/04tn4x': 299, '/m/04v6l4': 300, '/m/04vv5k': 301, '/m/04y4h8h': 302, '/m/04ylt': 303, '/m/04yqq2': 304, '/m/04yx4': 305, '/m/04z4wx': 306, '/m/04zpv': 307, '/m/04zwwv': 308, '/m/050gv4': 309, '/m/050k8': 310, '/m/052lwg6': 311, '/m/052sf': 312, '/m/05441v': 313, '/m/054_l': 314, '/m/054fyh': 315, '/m/054xkw': 316, '/m/05676x': 317, '/m/057cc': 318, '/m/057p5t': 319, '/m/0584n8': 320, '/m/058qzx': 321, '/m/05_5p_0': 322, '/m/05bm6': 323, '/m/05ctyq': 324, '/m/05gqfk': 325, '/m/05kms': 326, '/m/05kyg_': 327, '/m/05n4y': 328, '/m/05r5c': 329, '/m/05r655': 330, '/m/05s2s': 331, '/m/05vtc': 332, '/m/05w9t9': 333, '/m/05y5lj': 334, '/m/05z55': 335, '/m/05z6w': 336, '/m/05zsy': 337, '/m/061_f': 338, '/m/061hd_': 339, '/m/0633h': 340, '/m/063rgb': 341, '/m/0642b4': 342, '/m/065h6l': 343, '/m/0663v': 344, '/m/068zj': 345, '/m/06_72j': 346, '/m/06__v': 347, '/m/06_fw': 348, '/m/06bt6': 349, '/m/06c54': 350, '/m/06c7f7': 351, '/m/06j2d': 352, '/m/06k2mb': 353, '/m/06l9r': 354, '/m/06m11': 355, '/m/06mf6': 356, '/m/06msq': 357, '/m/06ncr': 358, '/m/06nrc': 359, '/m/06nwz': 360, '/m/06pcq': 361, '/m/06y5r': 362, '/m/06z37_': 363, '/m/07030': 364, '/m/0703r8': 365, '/m/071p9': 366, '/m/071qp': 367, '/m/073bxn': 368, '/m/073g6': 369, '/m/074d1': 370, '/m/0755b': 371, '/m/076bq': 372, '/m/076lb9': 373, '/m/078jl': 374, '/m/078n6m': 375, '/m/079cl': 376, '/m/07bgp': 377, '/m/07c52': 378, '/m/07c6l': 379, '/m/07clx': 380, '/m/07cmd': 381, '/m/07crc': 382, '/m/07cx4': 383, '/m/07dd4': 384, '/m/07dm6': 385, '/m/07fbm7': 386, '/m/07gql': 387, '/m/07j7r': 388, '/m/07j87': 389, '/m/07jdr': 390, '/m/07k1x': 391, '/m/07kng9': 392, '/m/07mcwg': 393, '/m/07mhn': 394, '/m/07pj7bq': 395, '/m/07qxg_': 396, '/m/07r04': 397, '/m/07v9_z': 398, '/m/07xyvk': 399, '/m/07y_7': 400, '/m/07yv9': 401, '/m/080hkjn': 402, '/m/080n7g': 403, '/m/081qc': 404, '/m/083kb': 405, '/m/083wq': 406, '/m/084hf': 407, '/m/084rd': 408, '/m/084zz': 409, '/m/0898b': 410, '/m/08dz3q': 411, '/m/08hvt4': 412, '/m/08ks85': 413, '/m/08p92x': 414, '/m/08pbxl': 415, '/m/096mb': 416, '/m/09728': 417, '/m/099ssp': 418, '/m/09b5t': 419, '/m/09csl': 420, '/m/09ct_': 421, '/m/09d5_': 422, '/m/09ddx': 423, '/m/09dzg': 424, '/m/09f20': 425, '/m/09f_2': 426, '/m/09g1w': 427, '/m/09gtd': 428, '/m/09gys': 429, '/m/09j2d': 430, '/m/09j5n': 431, '/m/09k_b': 432, '/m/09kmb': 433, '/m/09kx5': 434, '/m/09ld4': 435, '/m/09qck': 436, '/m/09rvcxw': 437, '/m/09tvcd': 438, '/m/0_cp5': 439, '/m/0_dqb': 440, '/m/0_k2': 441, '/m/0b3fp9': 442, '/m/0b_rs': 443, '/m/0bh9flk': 444, '/m/0bjyj5': 445, '/m/0bt9lr': 446, '/m/0bt_c3': 447, '/m/0bwd_0j': 448, '/m/0by6g': 449, '/m/0c06p': 450, '/m/0c29q': 451, '/m/0c2jj': 452, '/m/0c3m8g': 453, '/m/0c3mkw': 454, '/m/0c568': 455, '/m/0c9ph5': 456, '/m/0c_jw': 457, '/m/0ccs93': 458, '/m/0cd4d': 459, '/m/0cdl1': 460, '/m/0cdn1': 461, '/m/0cffdh': 462, '/m/0cgh4': 463, '/m/0ch_cf': 464, '/m/0cjq5': 465, '/m/0cjs7': 466, '/m/0cl4p': 467, '/m/0cmf2': 468, '/m/0cmx8': 469, '/m/0cn6p': 470, '/m/0cnyhnx': 471, '/m/0cqn2': 472, '/m/0crjs': 473, '/m/0ct4f': 474, '/m/0cvnqh': 475, '/m/0cxn2': 476, '/m/0cydv': 477, '/m/0cyf8': 478, '/m/0cyfs': 479, '/m/0cyhj_': 480, '/m/0czz2': 481, '/m/0d20w4': 482, '/m/0d4v4': 483, '/m/0d4w1': 484, '/m/0d5gx': 485, '/m/0d8zb': 486, '/m/0d_2m': 487, '/m/0dbvp': 488, '/m/0dbzx': 489, '/m/0dftk': 490, '/m/0dj6p': 491, '/m/0djtd': 492, '/m/0dkzw': 493, '/m/0dq75': 494, '/m/0dt3t': 495, '/m/0dtln': 496, '/m/0dv5r': 497, '/m/0dv77': 498, '/m/0dv9c': 499, '/m/0dzct': 500, '/m/0dzf4': 501, '/m/0f4s2w': 502, '/m/0f571': 503, '/m/0f6nr': 504, '/m/0f6wt': 505, '/m/0f8s22': 506, '/m/0f9_l': 507, '/m/0fbdv': 508, '/m/0fbw6': 509, '/m/0fj52s': 510, '/m/0fldg': 511, '/m/0fly7': 512, '/m/0fm3zh': 513, '/m/0fp6w': 514, '/m/0fqfqc': 515, '/m/0fqt361': 516, '/m/0frqm': 517, '/m/0fszt': 518, '/m/0ft9s': 519, '/m/0ftb8': 520, '/m/0fx9l': 521, '/m/0fz0h': 522, '/m/0gd2v': 523, '/m/0gd36': 524, '/m/0gj37': 525, '/m/0gjbg72': 526, '/m/0gjkl': 527, '/m/0gm28': 528, '/m/0grw1': 529, '/m/0gv1x': 530, '/m/0gxl3': 531, '/m/0h23m': 532, '/m/0h2r6': 533, '/m/0h8jyh6': 534, '/m/0h8kx63': 535, '/m/0h8l4fh': 536, '/m/0h8lkj8': 537, '/m/0h8mhzd': 538, '/m/0h8my_4': 539, '/m/0h8mzrc': 540, '/m/0h8n27j': 541, '/m/0h8n5zk': 542, '/m/0h8n6f9': 543, '/m/0h8n6ft': 544, '/m/0h8nm9j': 545, '/m/0h8nr_l': 546, '/m/0h8nsvg': 547, '/m/0h8ntjv': 548, '/m/0h99cwc': 549, '/m/0h9mv': 550, '/m/0hdln': 551, '/m/0hf58v5': 552, '/m/0hg7b': 553, '/m/0hkxq': 554, '/m/0hnnb': 555, '/m/0hnyx': 556, '/m/0hqkz': 557, '/m/0j496': 558, '/m/0jbk': 559, '/m/0jg57': 560, '/m/0jly1': 561, '/m/0jqgx': 562, '/m/0jwn_': 563, '/m/0jy4k': 564, '/m/0jyfg': 565, '/m/0k0pj': 566, '/m/0k1tl': 567, '/m/0k4j': 568, '/m/0k5j': 569, '/m/0k65p': 570, '/m/0km7z': 571, '/m/0kmg4': 572, '/m/0kpqd': 573, '/m/0kpt_': 574, '/m/0ky7b': 575, '/m/0l14j_': 576, '/m/0l3ms': 577, '/m/0l515': 578, '/m/0ll1f78': 579, '/m/0llzx': 580, '/m/0lt4_': 581, '/m/0m53l': 582, '/m/0mcx2': 583, '/m/0mkg': 584, '/m/0mw_6': 585, '/m/0n28_': 586, '/m/0nl46': 587, '/m/0nybt': 588, '/m/0p833': 589, '/m/0pcr': 590, '/m/0pg52': 591, '/m/0ph39': 592, '/m/0qjjc': 593, '/m/0qmmr': 594, '/m/0wdt60w': 595, '/m/0xfy': 596, '/m/0xzly': 597, '/m/0zvk5': 598}